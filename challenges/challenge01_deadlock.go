package challenges

import (
	"fmt"
	"time"
)

// Challenge01_FixDeadlock - ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ã®ä¿®æ­£
//
// ğŸ† å•é¡Œ: 2ã¤ã®goroutineãŒäº’ã„ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’å¾…ã¡ç¶šã‘ã¦ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ãŒç™ºç”Ÿã—ã¾ã™ã€‚
// ğŸ’¡ ãƒ’ãƒ³ãƒˆ: channelã®é€å—ä¿¡ã®é †åºã‚’è€ƒãˆã¦ã¿ã¦ãã ã•ã„ã€‚
func Challenge01_FixDeadlock() {
	fmt.Println("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
	fmt.Println("â•‘ ğŸ† ãƒãƒ£ãƒ¬ãƒ³ã‚¸1: ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ã‚’ä¿®æ­£ã›ã‚ˆ    â•‘")
	fmt.Println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
	fmt.Println("\nâš ï¸ ç¾åœ¨ã®çŠ¶æ…‹: ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ãŒç™ºç”Ÿã—ã¾ã™ï¼")

	ch1 := make(chan int)
	ch2 := make(chan int)

	// Goroutine 1
	go func() {
		ch1 <- 1 // ch1ã«é€ä¿¡
		val := <-ch2 // ch2ã‹ã‚‰å—ä¿¡ã‚’å¾…ã¤
		fmt.Printf("âœ… ã‚´ãƒ«ãƒ¼ãƒãƒ³1ãŒå—ä¿¡: %d\n", val)
	}()

	// Goroutine 2
	go func() {
		ch2 <- 2 // ch2ã«é€ä¿¡
		val := <-ch1 // ch1ã‹ã‚‰å—ä¿¡ã‚’å¾…ã¤
		fmt.Printf("âœ… ã‚´ãƒ«ãƒ¼ãƒãƒ³2ãŒå—ä¿¡: %d\n", val)
	}()

	time.Sleep(1 * time.Second)
	fmt.Println("ğŸ¯ ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ­£å¸¸çµ‚äº†")
}

// Challenge01_ExpectedOutput - æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›
func Challenge01_ExpectedOutput() {
	fmt.Println("\nğŸ“¦ æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:")
	fmt.Println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")
	fmt.Println("âœ… ã‚´ãƒ«ãƒ¼ãƒãƒ³1ãŒå—ä¿¡: 2")
	fmt.Println("âœ… ã‚´ãƒ«ãƒ¼ãƒãƒ³2ãŒå—ä¿¡: 1")
	fmt.Println("ğŸ¯ ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ­£å¸¸çµ‚äº†")
	fmt.Println("\nğŸ”§ ä¿®æ­£æ–¹æ³•ã®ãƒ’ãƒ³ãƒˆ:")
	fmt.Println("  1. ãƒãƒƒãƒ•ã‚¡ä»˜ããƒãƒ£ãƒãƒ«ã‚’ä½¿ç”¨")
	fmt.Println("  2. selectæ–‡ã‚’ä½¿ç”¨")
	fmt.Println("  3. é€å—ä¿¡ã®é †åºã‚’å¤‰æ›´")
}